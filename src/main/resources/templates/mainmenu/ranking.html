<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ranking</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<script>
  function qwe() {
    fetch("/ranking", {method: "POST"})
            .then(res => res.json())
            .then(data => {
              console.log(data)
              renderRankingList(data.oliveyoung.list, 1);   // ì˜¬ë¦¬ë¸Œì˜
              renderRankingList(data.qoo10.list, 2);   // íí…
              renderRankingList(data.coupang.list, 3); // ì¿ íŒ¡
              renderRankingList(data.amazon.list, 4);  // ì•„ë§ˆì¡´

            })
            .catch(err => console.error("API Error:", err));
  }

  function renderRankingList(list, type) {
    const container = document.getElementById(`rank${type}-items`);
    container.innerHTML = "";

    list.forEach((item, index) => {
      if (index === 0) container.innerHTML += renderFirstItem(item);
      else container.innerHTML += renderOtherItem(item, index);
    });
  }

  function renderFirstItem(item) {
    return `
    <div class="bg-white border border-emerald-200 rounded-xl shadow-md hover:shadow-lg transition p-4 w-full max-w-xs mx-auto">
      <a href="${item.url}" class="w-full h-52 bg-gray-100 rounded-lg flex items-center justify-center mb-4 block">
        <img src="${item.img}" alt="ëŒ€í‘œì´ë¯¸ì§€" class="w-full h-full object-cover">
      </a>
      <div class="space-y-1 text-center">
        <div class="text-emerald-600 text-sm font-bold">1ë“±</div>
        <div class="text-gray-800 font-semibold text-base truncate">${item.name}</div>
        <div class="text-gray-500 text-sm">${item.brand}</div>
        <div class="text-emerald-700 font-bold text-lg mt-2">${item.price}ì›</div>
      </div>
    </div>
  `;
  }
  function renderOtherItem(item, index) {
    return `
    <div class="bg-white border rounded-xl shadow-sm hover:shadow-md transition p-3 w-full max-w-xs mx-auto my-6 h-[380px]">
      <a href="${item.url}" class="w-full h-52 bg-gray-100 rounded-lg overflow-hidden block mb-3">
        <img src="${item.img}" alt="ëŒ€í‘œ ì´ë¯¸ì§€" class="w-full h-full object-cover">
      </a>

      <div class="text-center space-y-1">
        <div class="text-emerald-600 text-sm font-bold">${index + 1}ë“±</div>

        <div class="text-gray-800 font-medium text-sm overflow-hidden text-ellipsis"
             style="display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;">
          ${item.name.length > 50 ? item.name.substring(0, 50) + 'â€¦' : item.name}
        </div>

        <div class="text-gray-500 text-xs">${item.brand}</div>
        <div class="text-emerald-700 font-semibold text-base mt-1">${item.price}ì›</div>
      </div>
    </div>
  `;
  }
  window.onload = function() {
    qwe();
  };
</script>
<body class="bg-gray-50 min-h-screen flex flex-col">

<!-- âœ… Header -->
<div th:replace="~{fragments/basicheader :: basicheader-fragment('Ranking', 'ranking')}"></div>

<!-- âœ… Main Section -->
<main class="flex-grow pt-28 pb-16 px-6">
  <div class="max-w-7xl mx-auto">

    <!-- âœ… ë­í‚¹ ê·¸ë¦¬ë“œ -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">

      <!-- ğŸŸ¢ ì˜¬ë¦¬ë¸Œì˜ ë­í‚¹ -->
      <section class="bg-white shadow-md rounded-2xl p-6">
        <h2 id="rank1" class="text-xl font-semibold text-gray-800 mb-6 text-center">ì˜¬ë¦¬ë¸Œì˜ ë­í‚¹</h2>

        <div id="rank1-items" class="flex flex-col items-center"></div>
      </section>

      <!-- ğŸŸ¢ íí… ë­í‚¹ -->
      <section class="bg-white shadow-md rounded-2xl p-6">
        <h2 id="rank2" class="text-xl font-semibold text-gray-800 mb-6 text-center">íí… ë­í‚¹</h2>

        <div id="rank2-items" class="flex flex-col items-center"></div>
      </section>

      <!-- ğŸŸ¢ ì¿ íŒ¡ ë­í‚¹ -->
      <section class="bg-white shadow-md rounded-2xl p-6">
        <h2 id="rank3" class="text-xl font-semibold text-gray-800 mb-6 text-center">ì¿ íŒ¡ ë­í‚¹</h2>

        <div id="rank3-items" class="flex flex-col items-center"></div>
      </section>

      <!-- ğŸŸ¢ ì•„ë§ˆì¡´ ë­í‚¹ -->
      <section class="bg-white shadow-md rounded-2xl p-6">
        <h2 id="rank4" class="text-xl font-semibold text-gray-800 mb-6 text-center">ì•„ë§ˆì¡´ ë­í‚¹</h2>

        <div id="rank4-items" class="flex flex-col items-center"></div>
      </section>

    </div>
  </div>
</main>

<!-- âœ… Footer -->
<div th:replace="~{fragments/footer :: footer-fragment('ranking')}"></div>

</body>
</html>